---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: automation-hub

name: ci-int-automation-hub-jobs
description: automation-hub ci-int jobs

app:
  $ref: /services/insights/automation-hub/app.yml

instance:
  $ref: /dependencies/ci-int/ci-int.yml

type: jobs

config:
- project:
    name: galaxy_ng
    label: insights
    node: insights
    gh_org: ansible
    gh_repo: galaxy_ng
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: galaxy_ng pr-check
        branch: master
- project:
    name: ansible-hub-ui
    label: insights
    node: insights
    gh_org: ansible
    gh_repo: ansible-hub-ui
    quay_org: cloudservices
    jobs:
    - "insights-gh-pr-check":
        display_name: ansible-hub-ui pr-check
        branch: master
- project:
    name: automation-hub
    label: insights
    node: insights
    app_name: automation-hub
    include_ui: true
    ui_ref: qa-beta
    component_name: automation-hub
    image: "quay.io/cloudservices/automation-hub-galaxy-ng"
    git_commit: master
    image_tag: latest
    components_w_resources: all
    additional_arg: '--set-parameter $COMPONENT_NAME/IMPORTER_JOB_NAMESPACE=$NAMESPACE'
    post_deployment_script: ahub.sh
    jobs:
    - "insights-deploy-ephemeral":
        display_name: automation-hub ephemeral

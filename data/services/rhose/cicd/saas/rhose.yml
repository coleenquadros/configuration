---
$schema: /app-sre/saas-file-2.yml

labels:
  service: rhose

name: saas-rhose
description: SaaS tracking file for Red Hat Openshift Smart Events (RHOSE)

app:
  $ref: /services/rhose/app.yml

pipelinesProvider:
  $ref: /services/rhose/pipelines/rhose-pipelines.appsrep05ue1.yml

slack:
  workspace:
    $ref: /dependencies/slack/redhat-internal.yml
  channel: rhose-rts
  notifications:
    start: false

managedResourceTypes:
  - Deployment
  - Service
  - ConfigMap
  - CronJob

imagePatterns:
  - quay.io/app-sre/rhose-fleet-manager
  - quay.io/app-sre/ubi8-ubi

authentication:
  image:
    path: app-sre/quay/app-sre-pull
    field: all

resourceTemplates:
  - name: rhose
    url: https://github.com/5733d9e2be6485d52ffa08870cabdee0/sandbox
    path: /app-interface/manifests/rhose-fleet-manager.yml
    targets:
      - namespace:
          $ref: /services/rhose/namespaces/stage.yml
        ref: main
        upstream:
          instance:
            $ref: /dependencies/ci-ext/ci-ext.yml
          name: 5733d9e2be6485d52ffa08870cabdee0-sandbox-gh-build-main
        parameters:
          FLEET_MANAGER_IMAGE: quay.io/app-sre/rhose-fleet-manager
          FLEET_MANAGER_IMAGE_TAG: 9c202e48e2d1778b817266b6ceeefb2f540a1074
          FLEET_MANAGER_LIMITS_CPU: "2"
          FLEET_MANAGER_LIMITS_MEMORY: "4000Mi"
          FLEET_MANAGER_REQUESTS_CPU: "1"
          FLEET_MANAGER_REQUESTS_MEMORY: "2000Mi"
          FLEET_MANAGER_SECRET_NAME: fleet-manager
          FLEET_MANAGER_REPLICAS: "3"
          QUARKUS_LOG_LEVEL: "INFO"
          RDS_SECRET_NAME: rhosedb-rds
      - namespace:
          $ref:  /services/rhose/namespaces/production.yml
        ref: 41eb3cf808b854020199f33c2d1540306a84a60d
        parameters:
          FLEET_MANAGER_IMAGE: quay.io/app-sre/rhose-fleet-manager
          FLEET_MANAGER_IMAGE_TAG: cbdfa9a1e29e726cd7dbb23e8eff483ebe26879d
          FLEET_MANAGER_LIMITS_CPU: "2"
          FLEET_MANAGER_LIMITS_MEMORY: "4000Mi"
          FLEET_MANAGER_REQUESTS_CPU: "1"
          FLEET_MANAGER_REQUESTS_MEMORY: "2000Mi"
          FLEET_MANAGER_SECRET_NAME: fleet-manager
          QUARKUS_LOG_LEVEL: "INFO"
          RDS_SECRET_NAME: rhosedb-rds
          FLEET_MANAGER_REPLICAS: "3"

  - name: grafana-dashboard-rhose-fleet-manager
    url: https://github.com/5733d9e2be6485d52ffa08870cabdee0/sandbox
    path: /app-interface/dashboards
    provider: directory
    targets:
      - namespace:
          $ref: /services/observability/namespaces/app-sre-observability-stage.yml
        ref: main

  - name: rhose-cronjobs
    url: https://github.com/5733d9e2be6485d52ffa08870cabdee0/sandbox
    path: /app-interface/cronjobs
    provider: directory
    targets:
      - namespace:
          $ref: /services/rhose/namespaces/stage.yml
        ref: main

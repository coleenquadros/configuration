---
$schema: /app-sre/saas-file-2.yml

labels:
  service: rhose

name: saas-rhose
description: SaaS tracking file for Red Hat Openshift Smart Events (RHOSE)

app:
  $ref: /services/rhose/app.yml

pipelinesProvider:
  $ref: /services/rhose/pipelines/rhose-pipelines.app-sre-prod-01.yml

slack:
  workspace:
    $ref: /dependencies/slack/coreos.yml
  channel: rhose-team
  notifications:
    start: false

managedResourceTypes:
  - Deployment
  - Service
  - ConfigMap

imagePatterns:
  - quay.io/app-sre/rhose-fleet-manager

authentication:
  image:
    path: app-sre/quay/app-sre-pull
    field: all

resourceTemplates:
  - name: rhose
    url: https://github.com/5733d9e2be6485d52ffa08870cabdee0/sandbox
    path: /app-interface/manifests/rhose-fleet-manager.yml
    targets:
      - namespace:
          $ref: /services/rhose/namespaces/stage.yml
        ref: main
        upstream:
          instance:
            $ref: /dependencies/ci-ext/ci-ext.yml
          name: 5733d9e2be6485d52ffa08870cabdee0-sandbox-gh-build-main
        parameters:
          FLEET_MANAGER_IMAGE: quay.io/app-sre/rhose-fleet-manager
          FLEET_MANAGER_IMAGE_TAG: be5ab0d
          FLEET_MANAGER_SSO_URL: https://sso.redhat.com/auth/realms/redhat-external
          FLEET_MANAGER_SSO_CLIENT_ID: cloud-services
          RDS_SECRET_NAME: rhosedb-rds
          FLEET_MANAGER_SECRET_NAME: fleet-manager
      - namespace:
          $ref:  /services/rhose/namespaces/production.yml
        ref: a0061ec2ee7cb0e8b2e5e1a50e087ee128d19624
        parameters:
          FLEET_MANAGER_IMAGE: quay.io/app-sre/rhose-fleet-manager
          FLEET_MANAGER_IMAGE_TAG: be5ab0d
          FLEET_MANAGER_SSO_URL: https://sso.redhat.com/auth/realms/redhat-external
          FLEET_MANAGER_SSO_CLIENT_ID: cloud-services
          RDS_SECRET_NAME: rhosedb-rds
          FLEET_MANAGER_SECRET_NAME: fleet-manager

  - name: grafana-dashboard-rhose-fleet-manager
    url: https://github.com/5733d9e2be6485d52ffa08870cabdee0/sandbox
    path: /app-interface/dashboards
    provider: directory
    targets:
    - namespace:
        $ref: /services/observability/namespaces/app-sre-observability-stage.yml
      ref: main

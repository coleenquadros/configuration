---
$schema: /dependencies/jenkins-config-1.yml

labels:
  service: app-sre

name: ci-ext-app-sre-jobs

description: ''

instance:
  $ref: /dependencies/ci-ext/ci-ext.yml

type: jobs

config:
- project:
    name: fluentd
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: fluentd
    quay_org: app-sre
    kube_cluster: none
    build_deploy_script_path: "./build_deploy.sh"
    jobs:
    - 'gh-build-master':
        display_name: fluentd build master

- project:
    name: jjb
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: jenkins-job-builder
    quay_org: app-sre
    kube_cluster: none
    build_deploy_script_path: "./build_deploy.sh"
    jobs:
    - 'gh-build-master':
        display_name: jenkins-job-builder image build master

- project:
    name: manifest-bouncer
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: manifest-bouncer
    quay_org: app-sre
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: manifest-bouncer build master
    - 'gh-pr-check':
        display_name: manifest-bouncer pr-check
    - 'gh-build-tag':
        display_name: manifest-bouncer publish to pypi

- project:
    name: s3-reload
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: s3-reload
    quay_org: app-sre
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: s3-reload build master

- project:
    name: git-keeper
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: git-keeper
    quay_org: app-sre
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: git-keeper build master
    - 'gh-pr-check':
        display_name: git-keeper pr-check

- project:
    name: nginx-gate
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: nginx-gate
    quay_org: app-sre
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: nginx-gate build master

- project:
    name: cvexporter
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: container-vulnerability-exporter
    quay_org: app-sre
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: cvexporter build master
    - 'gh-pr-check':
        pr_check_script_path: make test
        display_name: cvexporter pr-check test

- project:
    name: sretoolbox
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: sretoolbox
    quay_org: none
    kube_cluster: none
    jobs:
    - 'gh-pr-check':
        display_name: sretoolbox pr-check
    - 'gh-build-tag':
        display_name: sretoolbox publish to pypi

- project:
    name: app-sre-errbot
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: app-sre-errbot
    quay_org: app-sre
    build_deploy_script_path: "./hack/build_deploy.sh"
    pr_check_script_path: "./hack/pr_check.sh"
    kube_cluster: none
    jobs:
    - 'gh-build-master':
        display_name: app-sre-errbot build master
    - 'gh-pr-check':
        display_name: app-sre-errbot pr check

- project:
    name: rds-enhanced-metrics-exporter
    label: app-sre
    node: app-sre
    gh_org: app-sre
    gh_repo: rds-enhanced-metrics-exporter
    pr_check_script_path: "./pr_check.sh"
    kube_cluster: none
    jobs:
    - 'gh-pr-check':
        display_name: pr-check rds-enhanced-metrics-exporter
        concurrent_build: false
    - 'gh-build-master':
        display_name: build and push image rds-enhanced-metrics-exporter
        build_deploy_script_path: "./build_deploy.sh"

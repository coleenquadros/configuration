---
$schema: /dependencies/jenkins-instance-1.yml

labels:
  service: ci-int

name: ci-int
description: Internal CI instance for the App SRE managed services

serverUrl: https://ci.int.devshift.net
token:
  path: app-sre/ci-int/jjb-ini
  field: jjb-ini-toml

# adjust jenkins-webhooks-cleaner cron expression or remove it to cause webhooks to be deleted.
previousUrls:
- https://ci-int-jenkins.rhev-ci-vms.eng.rdu2.redhat.com

workerFleets:
- identifier: ci-int-jenkins-worker-app-interface
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: app-interface
  numExecutors: 3
  minSpareSize: 1
  maxTotalUses: 100
  idleMinutes: 5
- identifier: ci-int-jenkins-worker-app-sre
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: app-sre app-interface-long-running managed-services osde2e qe quarkus backplane osd-operators
  numExecutors: 3
  maxTotalUses: 200
- identifier: ci-int-jenkins-worker-hive
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: backplane osd-operators
  numExecutors: 3
  maxTotalUses: 100
- identifier: ci-int-jenkins-worker-service-development
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: sd-service-development-b sd-uhc
  numExecutors: 3
  maxTotalUses: 100
- identifier: ci-int-jenkins-worker-insights
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: insights
  numExecutors: 3
  maxTotalUses: 200
- identifier: ci-int-jenkins-worker-rhel7
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: rhel7
  numExecutors: 3
  maxTotalUses: 100
- identifier: ci-int-jenkins-worker-rhel8
  account: app-sre
  namespace:
    $ref: /services/app-sre/namespaces/app-sre-ci.yaml
  credentialsId: jenkins
  fsRoot: /var/lib/jenkins
  labelString: rhel8
  numExecutors: 3
  maxTotalUses: 200

buildsCleanupRules:
  - name: '^openshift-saas-deploy-'
    keep_hours: 744
  - name: 'build-'
    keep_hours: 744
  - name: '-pr-check'
    keep_hours: 168
  - name: 'app-interface-output-run'
    keep_hours: 24
  - name: 'insights-saas-templates-sync'
    keep_hours: 24
  - name: 'insights-ephemeral-namespace-reconciler'
    keep_hours: 24
  - name: 'osde2e-metrics-sync'
    keep_hours: 24
  - name: 'clusterimageset-run'
    keep_hours: 24
  - name: 'insights-platform-advisor-backend-smoke-test-'
    keep_hours: 24
  - name: 'gl-track-cna-modules'
    keep_hours: 24
  - name: ''
    keep_hours: 360

#plugins:
#- ace-editor
#- ansicolor
#- ant
#- antisamy-markup-formatter
#- apache-httpcomponents-client-4-api
#- authentication-tokens
#- bouncycastle-api
#- branch-api
#- build-timeout
#- build-timestamp
#- cloudbees-folder
#- cobertura
#- command-launcher
#- credentials
#- credentials-binding
#- cvs
#- display-url-api
#- docker-commons
#- docker-workflow
#- durable-task
#- email-ext
#- envinject
#- envinject-api
#- external-monitor-job
#- ghprb
#- git
#- git-client
#- git-server
#- github
#- github-api
#- github-branch-source
#- github-oauth
#- gitlab-plugin
#- greenballs
#- handlebars
#- hashicorp-vault-plugin
#- htmlpublisher
#- jackson2-api
#- javadoc
#- jaxb
#- jdk-tool
#- jira
#- jms-messaging
#- jquery-detached
#- jsch
#- junit
#- kerberos-sso
#- ldap
#- mailer
#- mapdb-api
#- matrix-auth
#- matrix-project
#- maven-plugin
#- metrics
#- momentjs
#- monitoring
#- naginator
#- pam-auth
#- pipeline-build-step
#- pipeline-graph-analysis
#- pipeline-input-step
#- pipeline-milestone-step
#- pipeline-model-api
#- pipeline-model-declarative-agent
#- pipeline-model-definition
#- pipeline-model-extensions
#- pipeline-rest-api
#- pipeline-stage-step
#- pipeline-stage-tags-metadata
#- pipeline-stage-view
#- plain-credentials
#- postbuildscript
#- prometheus
#- rebuild
#- resource-disposer
#- role-strategy
#- saferestart
#- scm-api
#- script-security
#- simple-theme-plugin
#- skip-certificate-check
#- ssh-agent
#- ssh-credentials
#- ssh-slaves
#- structs
#- subversion
#- text-finder
#- thinBackup
#- throttle-concurrents
#- timestamper
#- token-macro
#- variant
#- view-job-filters
#- windows-slaves
#- workflow-aggregator
#- workflow-api
#- workflow-basic-steps
#- workflow-cps
#- workflow-cps-global-lib
#- workflow-durable-task-step
#- workflow-job
#- workflow-multibranch
#- workflow-scm-step
#- workflow-step-api
#- workflow-support
#- ws-cleanup

apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  labels:
    prometheus: app-sre
    role: alert-rules
  name: deployment-validation-operator-no-liveness-probe
spec:
  groups:
  - name: deployment-validation-operator-no_liveness_probe.rules
    rules:
    - alert: deployment_validation_operator_no_liveness_probe
      annotations:
        dashboard: https://grafana.app-sre.devshift.net/d/dashdotdb/dash-db?orgId=1&var-datasource=dashdotdb-rds&var-cluster=test-cluster&var-namespace=cloudwatch-exporter-tests-ns
        html_url: https://gitlab.cee.redhat.com/service/app-interface/blob/master/resources/services/deployment-validation-operator/prometheusrules-no_liveness_probe.yaml.j2
        message: 'deployment_validation_operator_no_liveness_probe Validation error
          for cloudwatch-exporter-tests: {{ $labels.check_description }}'
        runbook: '{{ $labels.check_remediation }}'
      expr: 'deployment_validation_operator_no_liveness_probe{exported_namespace="cloudwatch-exporter-tests-ns",kind!~"CronJob|Job|ReplicaSet",name!~"openshift-acme|gabi"}
        > 0

        '
      for: 1m
      labels:
        app: cloudwatch-exporter-tests
        jiralert: TEST
        service: deployment-validation-operator
        severity: medium
    - alert: deployment_validation_operator_no_liveness_probe
      annotations:
        dashboard: https://grafana.app-sre.devshift.net/d/dashdotdb/dash-db?orgId=1&var-datasource=dashdotdb-rds&var-cluster=test-cluster&var-namespace=app-metadata-tests-ns
        html_url: https://gitlab.cee.redhat.com/service/app-interface/blob/master/resources/services/deployment-validation-operator/prometheusrules-no_liveness_probe.yaml.j2
        message: 'deployment_validation_operator_no_liveness_probe Validation error
          for app-metadata-tests: {{ $labels.check_description }}'
        runbook: '{{ $labels.check_remediation }}'
      expr: 'deployment_validation_operator_no_liveness_probe{exported_namespace="app-metadata-tests-ns",kind!~"CronJob|Job|ReplicaSet",name!~"openshift-acme|gabi"}
        > 0

        '
      for: 1m
      labels:
        app: app-metadata-tests
        jiralert: TEST
        service: deployment-validation-operator
        severity: medium
    - alert: deployment_validation_operator_no_liveness_probe
      annotations:
        dashboard: https://grafana.app-sre.devshift.net/d/dashdotdb/dash-db?orgId=1&var-datasource=dashdotdb-rds&var-cluster=test-cluster&var-namespace=dvo-tests-ns
        html_url: https://gitlab.cee.redhat.com/service/app-interface/blob/master/resources/services/deployment-validation-operator/prometheusrules-no_liveness_probe.yaml.j2
        message: 'deployment_validation_operator_no_liveness_probe Validation error
          for dvo-tests: {{ $labels.check_description }}'
        runbook: '{{ $labels.check_remediation }}'
      expr: 'deployment_validation_operator_no_liveness_probe{exported_namespace="dvo-tests-ns",kind!~"CronJob|Job|ReplicaSet",name!~"openshift-acme|gabi"}
        > 0

        '
      for: 1m
      labels:
        app: dvo-tests
        jiralert: TEST
        service: deployment-validation-operator
        severity: medium
